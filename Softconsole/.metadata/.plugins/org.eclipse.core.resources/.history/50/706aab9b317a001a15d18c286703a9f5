

#include <stdlib.h>


#include "cpu_types.h"

#define BIT0        0x01u
#define BIT1        0x02u
#define BIT2        0x04u
#define BIT3        0x08u
#define BIT4        0x10u
#define BIT5        0x20u
#define BIT6        0x40u
#define BIT7        0x80u


#define FFT_CTRL_ADDR           0 << 2
#define FFT_STAT_ADDR           1 << 2
#define FFT_DIN_R_ADDR          2 << 2
#define FFT_DIN_I_ADDR          3 << 2
#define FFT_DOUT_R_ADDR         4 << 2
#define FFT_DOUT_I_ADDR         5 << 2
#define ABS_VAL_ADDR            6 << 2
#define FFT_DOUT_ADR_ADDR       7 << 2


#define CTRL_WRITE_EN           BIT0
#define CTRL_LOAD_DONE          BIT1
#define CTRL_READ_DONE          BIT2


typedef struct fft_instance
{
    addr_t address;
} fft_instance_t;



void fft_init
(
    fft_instance_t * fft_inst,
    addr_t base_addr
);

void fft_load_smpl
(
    fft_instance_t * fft_inst,
    uint16_t real,
    uint16_t imag
);

void fft_load_done
(
    fft_instance_t * fft_inst
);

void fft_read_done
(
    fft_instance_t * fft_inst
);

int fft_read_smpl
(
    fft_instance_t * fft_inst,
    uint16_t smpl_addr,
    uint16_t * real,
    uint16_t * imag,
    uint16_t * abs_val
);